!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){var s;t.exports=((s=function(){function t(t){return h.appendChild(t.dom),t}function e(t){for(var e=0;e<h.children.length;e++)h.children[e].style.display=e===t?"block":"none";i=t}var i=0,h=document.createElement("div");h.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",h.addEventListener("click",(function(t){t.preventDefault(),e(++i%h.children.length)}),!1);var r=(performance||Date).now(),n=r,a=0,o=t(new s.Panel("FPS","#0ff","#002")),l=t(new s.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new s.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:h,addPanel:t,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(l.update(t-r,200),t>n+1e3&&(o.update(1e3*a/(t-n),100),n=t,a=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:h,setMode:e}}).Panel=function(t,e,i){var s=1/0,h=0,r=Math.round,n=r(window.devicePixelRatio||1),a=80*n,o=48*n,l=3*n,c=2*n,d=3*n,u=15*n,f=74*n,p=30*n,m=document.createElement("canvas");m.width=a,m.height=o,m.style.cssText="width:80px;height:48px";var y=m.getContext("2d");return y.font="bold "+9*n+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=i,y.fillRect(0,0,a,o),y.fillStyle=e,y.fillText(t,l,c),y.fillRect(d,u,f,p),y.fillStyle=i,y.globalAlpha=.9,y.fillRect(d,u,f,p),{dom:m,update:function(o,x){s=Math.min(s,o),h=Math.max(h,o),y.fillStyle=i,y.globalAlpha=1,y.fillRect(0,0,a,u),y.fillStyle=e,y.fillText(r(o)+" "+t+" ("+r(s)+"-"+r(h)+")",l,c),y.drawImage(m,d+n,u,f-n,p,d,u,f-n,p),y.fillRect(d+f-n,u,n,p),y.fillStyle=i,y.globalAlpha=.9,y.fillRect(d+f-n,u,n,r((1-o/x)*p))}}},s)},function(t,e,i){"use strict";i.r(e);const s=document.getElementById("canvas"),h=s.getContext("2d");let r=s.clientHeight,n=s.clientWidth;const a=t=>t*n/100,o=t=>t*r/100,l={blueOne:"#69D2E7",blueTwo:"#A7DBD8",goldFishOne:"#F38630",goldFishTwo:"#FA6900",testing:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","006837"],simpleFish:["#f3beb4","#b86454"],jumperFish:["#87a8eb","#4966a1"],pufferFish:["#E0E4CC"],pufferFishTail:"#c9cdb7",pufferFishMouth:"#f0b1a5"};console.log(d3.interpolatePlasma);const c={x:a(50),y:o(50),radius:o(1.5),diameter:2*o(1.5),vx:0,vy:0,theta:0,speedDelta:o(.0135),thetaDelta:o(.0145)},d=[];d.push(...new Array(1).fill("puffer")),d.push(...new Array(4).fill("jumper")),d.push(...new Array(12).fill("simple"));let u=[];const f={fishEaten:0,score:0,progress:0,elapsed:0,enemyCount:25,stage:1};function p(t,e,i,s,h){return{x:Math.cos(h)*(t-i)-Math.sin(h)*(e-s)+i,y:Math.sin(h)*(t-i)+Math.cos(h)*(e-s)+s}}function m(t,e,i,s,h,r,n){const a=[],o=e*Math.sqrt(3)/2,l=n||1;a.push(p(s,h-2*o/3,s,h,i)),a.push(p(s+e/2,h+l*(o/3),s,h,i)),a.push(p(s-e/2,h+l*(o/3),s,h,i)),r&&(t.fillStyle=r),t.beginPath(),t.moveTo(a[0].x,a[0].y),t.lineTo(a[1].x,a[1].y),t.lineTo(a[2].x,a[2].y),t.lineTo(a[0].x,a[0].y),t.fill(),t.closePath()}function y(t,e,i,s,h,r,n){n&&(t.fillStyle=n),t.beginPath(),t.ellipse(e,i,s,h,r,0,2*Math.PI),t.fill(),t.closePath()}function x(t,e,i){return t*(1-i)+e*i}function M(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function g(t){return"#"+((1<<24)+(t[0]<<16)+(t[1]<<8)+t[2]).toString(16).slice(1)}function v(){const t=o(3),e=o(6.5),i=t+e*Math.random(),s=2500+10*i,h=a(.008),r=Math.random()>=.5?"left":"right",n="right"===r?-i:a(100)+i,c=Math.random()*o(100),d=M(l.jumperFish[0]),u=M(l.jumperFish[1]);var f,p,m;return{size:i,cycleTime:s,speed:h,x:n,y:c,direction:r,color:g((f=d,p=u,m=(i-t)/(e-t),[Math.round(f[0]*(1-m)+p[0]*m),Math.round(f[1]*(1-m)+p[1]*m),Math.round(f[2]*(1-m)+p[2]*m)]))}}class P{constructor(t,e,i,s,h,r,n){this.cycleTime=e,this.direction=r,this.color=n,this.size=t,this.vertices=4,this.x=s,this.y=h,this.vx=i,this.collision,this.state=[{start:0,end:.3,speed:this.vx,value:"coil"},{start:.2,end:.99,speed:5*this.vx,value:"jump"},{start:.75,end:1,speed:2*this.vx,value:"coil"}],this.coords={neutral:[[-t/2,0],[0,-t/2],[t/2,0],[0,t/2]],coil:[[-t/2,0],[0,-t],[t/2,0],[0,t]],jump:[[-t,0],[0,-t/2],[t,0],[0,t/2]]},this.currentCoords,this.diameter,this.dispose}reposition(t){const e=t%this.cycleTime/this.cycleTime,i=this.state.filter(t=>t.start<=e&&t.end>e),s=i.length>1?"transition":"stable",h=[];for(let t=0;t<this.vertices;t++){h[t]=[this.x,this.y];const r=new Array(2);if("transition"===s){const s=i[0],h=i[1];let n;s.start===h.start&&s.end<=h.end?n=(e-s.start)/(s.end-s.start):s.start<=h.start&&s.end<h.end?n=(e-h.start)/(s.end-h.start):s.start<h.start&&s.end===h.end&&(n=(e-h.end)/(h.end-h.start));const a=x(s.speed,h.speed,n);"left"===this.direction?this.x-=a:this.x+=a,r[0]=x(this.coords[s.value][t][0],this.coords[h.value][t][0],n),r[1]=x(this.coords[s.value][t][1],this.coords[h.value][t][1],n)}else{const e=i[0],s=e.speed;"left"===this.direction?this.x-=s:this.x+=s,r[0]=this.coords[e.value][t][0],r[1]=this.coords[e.value][t][1]}h[t][0]+=r[0],h[t][1]+=r[1]}this.currentCoords=h}collisionDetection(t,e,i){for(let s=0;s<this.currentCoords.length-1;s++){const h=i*i;let r=Math.pow(t-this.currentCoords[s][0],2),n=Math.pow(e-this.currentCoords[s][1],2);if(r+n<h)return!0;const a=(this.currentCoords[s][0]+this.currentCoords[s+1][0])/2,o=(this.currentCoords[s][1]+this.currentCoords[s+1][1])/2;if((r=(t-a)*(t-a))+(n=(e-o)*(e-o))<h)return!0}return!1}calculateDiameter(){const t=Math.abs(this.currentCoords[0][0]-this.currentCoords[2][0]),e=Math.abs(this.currentCoords[1][1]-this.currentCoords[2][1]);return Math.max(t,e)}render(t,e,i,s,h){this.reposition(e),this.diameter=this.calculateDiameter(),(this.x+this.size<a(0)||this.x-this.size>a(100))&&(this.dispose=!0),(Math.abs(i-this.x)<4*this.size||Math.abs(s-this.y)<4*this.size)&&(this.collision=this.collisionDetection(i,s,h)),t.fillStyle=this.color,t.beginPath(),this.currentCoords.map((e,i)=>{0===i?t.moveTo(e[0],e[1]):t.lineTo(e[0],e[1])}),t.fill(),t.closePath()}}function z(){const t=o(1),e=o(7),i=t+o(6)*Math.random(),s=30+i,h=a(.05)-i/100+Math.random()*a(.075),r=Math.random()>=.5?"left":"right",n="right"===r?-i:a(100)+i,c=Math.random()*o(100),d=(i-t)/(e-t);console.log(d);const u=g(function(t,e){const i=Math.ceil(t*(e.length-1)),s=(i-1)/(e.length-1),h=i/(e.length-1),r=(t-s)/(h-s),n=M(e[i-1]),a=M(e[i]);return console.log(s,h,t),console.log(t,i,e,n,a,r),[Math.round(n[0]*(1-r)+a[0]*r),Math.round(n[1]*(1-r)+a[1]*r),Math.round(n[2]*(1-r)+a[2]*r)]}(d,l.testing));return console.log(u),{size:i,cycleTime:s,speed:h,x:n,y:c,direction:r,color:u}}class b{constructor(t,e,i,s,h,r,n){this.size=t,this.diameter=2*t,this.cycleTime=e,this.vx=i,this.x=s,this.y=h,this.direction=r,this.color=n,this.vertices=4,this.tailSide=1.3*this.size,this.tailHeight=this.tailSide*Math.sqrt(3)/2,this.coords=[[0,this.tailSide/2],[-this.tailSide/2,this.tailHeight+this.size/2],[this.tailSide/2,this.tailHeight+this.size/2],[0,this.tailSide/2]],this.currentCoords,this.collision,this.dispose=!1}reposition(t){const e=[];"left"===this.direction?this.x-=this.vx:this.x+=this.vx,this.coords.map((i,s)=>{const h=this.x+i[0],r=this.y+i[1];let n;n="left"===this.direction?-Math.PI/2:Math.PI/2;const a=Math.PI/16*Math.sin(t/this.cycleTime),o=p(h,r,this.x,this.y,n+a);e.push([o.x,o.y])}),this.currentCoords=e}collisionDetection(t,e,i){const s=(this.x-t)*(this.x-t)+(this.y-e)*(this.y-e),h=(this.size+i)*(this.size+i);this.collision=s<h}render(t,e,i,s,h){this.reposition(e),(this.x+this.size<a(0)||this.x-this.size>a(100))&&(this.dispose=!0),(Math.abs(this.x-i)<4*h||Math.abs(this.y-s)<4*h)&&this.collisionDetection(i,s,h),t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fill(),t.closePath(),t.beginPath(),this.currentCoords.map((e,i)=>{0===i?t.moveTo(e[0],e[1]):t.lineTo(e[0],e[1])}),t.fill(),t.closePath()}}class w{constructor(t,e,i,s,h,r,n){this.cycleTime=e,this.direction=r,this.color=n,this.size=t,this.x=s,this.y=h,this.vx=i,this.state=[{start:0,end:.6,radius:this.size,speed:1.2*this.vx,value:"neutral"},{start:.5,end:.65,radius:this.size,speed:.75*this.vx,value:"huffing"},{start:.6,end:1,radius:3*this.size,speed:.5*this.vx,value:"puffing"},{start:.95,end:1,radius:this.size,speed:this.vx,value:"neutral"}],this.collision,this.currentState,this.currentCoords,this.diameter,this.dispose}reposition(t){const e=t%this.cycleTime/this.cycleTime;this.currentState=this.state.filter(t=>t.start<=e&&t.end>e);if("transition"===(this.currentState.length>1?"transition":"stable")){const t=this.currentState[0],i=this.currentState[1];let s;t.start===i.start&&t.end<=i.end?s=(e-t.start)/(t.end-t.start):t.start<=i.start&&t.end<i.end?s=(e-i.start)/(t.end-i.start):t.start<i.start&&t.end===i.end&&(s=(e-i.start)/(i.end-i.start));const h=x(t.speed,i.speed,s);"left"===this.direction?this.x-=h:this.x+=h;const r=x(t.radius,i.radius,s);this.size=r}else{const t=this.currentState[0],e=t.speed;"left"===this.direction?this.x-=e:this.x+=e,this.size=t.radius}this.finSize=this.size/2,this.finHeight=this.finSize*Math.sqrt(3)/2,this.currentCoords=[]}collisionDetection(t,e,i){const s=(this.x-t)*(this.x-t)+(this.y-e)*(this.y-e),h=(this.size+i)*(this.size+i);this.collision=s<h}render(t,e,i,s,h){this.reposition(e),this.diameter=2*this.size;const r=.25*Math.sin(this.vx*e/50),n=this.currentState.filter(t=>"huffing"===t.value).length>0?1+.25*Math.abs(Math.sin(e/100)):1;(this.x+this.size<a(0)||this.x-this.size>a(100))&&(this.dispose=!0),(Math.abs(this.x-i)<4*h||Math.abs(this.y-s)<4*h)&&this.collisionDetection(i,s,h),function(t,e,i,s,h,r,n){for(let a=0;a<e;a++){const o=2*Math.PI*(a/e);m(t,i,Math.PI/2+o,s+Math.cos(o)*r,h+Math.sin(o)*r,n)}}(t,25,this.size/8,this.x,this.y,this.size,l.pufferFish[0]),y(t,"left"===this.direction?this.x-this.size:this.x+this.size,this.y,n*(this.size/8),n*(this.size/3.4),0,l.pufferFishMouth),m(t,this.size,"left"===this.direction?-Math.PI/2:Math.PI/2,"left"===this.direction?this.x+this.size:this.x-this.size,this.y,l.pufferFishTail),function(t,e,i,s,h){h&&(t.fillStyle=h),t.beginPath(),t.arc(e,i,s,0,2*Math.PI),t.fill(),t.closePath()}(t,this.x,this.y,this.size,l.pufferFish[0]),m(t,this.size/2,"left"===this.direction?-Math.PI/2:Math.PI/2,"left"===this.direction?this.x+this.size/4:this.x-this.size/4,this.y,l.pufferFishTail,r),y(t,"left"===this.direction?this.x-this.size/1.75:this.x+this.size/1.75,this.y-this.size/3,this.size/6,this.size/5,0,"#FFFFFF"),y(t,"left"===this.direction?this.x-this.size/1.75:this.x+this.size/1.75,this.y-this.size/3,this.size/12,this.size/10,0,l.pufferFishTail)}}var S=i(0);const I=new(i.n(S).a);function T(t){if(I.begin(),h.clearRect(0,0,n,r),h.fillStyle=l.blueOne,h.fillRect(0,0,n,r),Math.sqrt(c.vx*c.vx+c.vy*c.vy),c.leftPressed&&(c.vx-=c.speedDelta,c.theta>Math.PI/2?c.theta=x(c.theta,3*Math.PI/2,c.thetaDelta):c.theta<=Math.PI/2&&(c.theta=x(c.theta,-Math.PI/2,c.thetaDelta))),c.upPressed&&(c.vy-=c.speedDelta,c.theta<Math.PI&&c.theta>=0?c.theta=x(c.theta,0,c.thetaDelta):c.theta=x(c.theta,2*Math.PI,c.thetaDelta)),c.rightPressed&&(c.vx+=c.speedDelta,c.theta<3*Math.PI/2&&c.theta>=Math.PI/2?c.theta=x(c.theta,Math.PI/2,c.thetaDelta):c.theta>=3*Math.PI/2?c.theta=x(c.theta,5*Math.PI/2,c.thetaDelta):c.theta=x(c.theta,Math.PI/2,c.thetaDelta)),c.downPressed&&(c.vy+=c.speedDelta,c.theta=x(c.theta,Math.PI,c.thetaDelta)),c.theta>2*Math.PI?c.theta=c.theta-2*Math.PI:c.theta<0&&(c.theta=2*c.theta+2*Math.PI),c.x+=c.vx,c.y+=c.vy,c.x>=n+c.radius?c.x=-c.radius:c.x<=-c.radius&&(c.x=n+c.radius),c.y>=r+c.radius?c.y=-c.radius:c.y<=-c.radius&&(c.y=r+c.radius),function(){h.fillStyle=l.goldFishTwo,h.beginPath(),h.arc(c.x,c.y,c.radius,0,2*Math.PI),h.fill(),h.closePath();const t=1.5*c.radius,e=t*Math.sqrt(3)/2,i=[[c.x,c.y+c.radius/2],[c.x-t/2,c.y+e+c.radius/2],[c.x+t/2,c.y+e+c.radius/2],[c.x,c.y+c.radius/2]];h.beginPath(),i.map((t,e)=>{const i=p(t[0],t[1],c.x,c.y,c.theta);0===e?h.moveTo(i.x,i.y):h.lineTo(i.x,i.y)}),h.fill(),h.closePath(),h.save()}(),u.length<f.enemyCount&&Math.random()>.6){switch(d[Math.floor(Math.random()*d.length)]){case"simple":{const{size:t,cycleTime:e,speed:i,x:s,y:h,direction:r,color:n}=z();u.push(new b(t,e,i,s,h,r,n));break}case"jumper":{const{size:t,cycleTime:e,speed:i,x:s,y:h,direction:r,color:n}=v();u.push(new P(t,e,i,s,h,r,n));break}case"puffer":{const{size:t,cycleTime:e,speed:i,x:s,y:h,direction:r,color:n}=function(){const t=o(3)+o(5)*Math.random(),e=8500+10*t,i=a(.015)+Math.random()*a(.025),s=Math.random()>=.5?"left":"right";return{size:t,cycleTime:e,speed:i,x:"right"===s?-t:a(100)+t,y:Math.random()*o(100),direction:s,color:l.pufferFish}}();u.push(new w(t,e,i,s,h,r,n))}}}const e=[];u.map((i,s)=>{i.render(h,t,c.x,c.y,c.radius),i.collision&&(console.log(i.diameter,c.diameter),i.diameter<c.diameter?(c.radius+=i.diameter/20,c.diameter=2*c.radius,e.push(s),f.fishEaten++,f.score+=1e3*i.diameter/o(100),f.progress=c.diameter/o(100),document.getElementById("count").innerText=f.fishEaten,document.getElementById("score").innerText=Number(Math.round(f.score)).toLocaleString("en"),document.getElementById("progress").style.width=`${6*f.progress}vw`,console.log("mmmmm")):console.log("owwww")),!0===i.dispose&&e.push(s)});for(let t=0;t<e.length;t++)u.splice(e[t],1);I.end(),requestAnimationFrame(T)}function D(t){switch(t.which||t.keyCode){case 37:c.leftPressed=!0;break;case 38:c.upPressed=!0;break;case 39:c.rightPressed=!0;break;case 40:c.downPressed=!0}}function C(t){switch(t.which||t.keyCode){case 37:c.leftPressed=!1;break;case 38:c.upPressed=!1;break;case 39:c.rightPressed=!1;break;case 40:c.downPressed=!1}}s.height=r,s.width=n,I.showPanel(0),document.body.append(I.dom),document.addEventListener("keydown",D,!1),document.addEventListener("keyup",C,!1),document.addEventListener("resize",()=>{height=s.clientHeight,width=s.clientWidth,s.width=width,s.height=height},!1),T(0)}]);